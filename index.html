<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Colleague Memory Task</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 20px;
    }
    img {
      max-width: 80%;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      margin-bottom: 20px;
    }
    .button {
      background-color: #007bff;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    .button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div id="content"></div>
  <button class="button" onclick="nextPage()">Next</button>
  <script>
    // Set up QiMessaging for Pepper
    try {
      // Attempt to connect to QiMessaging
      var session = new QiSession();
      session.connected.then(function(isConnected) {
        console.log("Connected to Pepper's QiMessaging");
      }).catch(function(error) {
        console.error("Could not connect to QiMessaging:", error);
      });
    } catch (e) {
      console.error("QiMessaging API not available:", e);
    }

    // Function to make Pepper speak
    function sayText(text) {
      try {
        session.service("ALTextToSpeech").then(function(tts) {
          tts.say(text);
        }).catch(function(error) {
          console.error("Error using text to speech service:", error);
        });
      } catch (e) {
        console.error("Error making Pepper speak:", e);
      }
    }

    window.onload = function () {
      var imageSources = [
        "page1.png",
        "page2.png",
        "page3.png",
        "page4.png",
        "page5.png",
        "page6.png",
        "page7.png"
      ];
      
      // Corresponding text for Pepper to speak on each page
      var speechTexts = [
        "Welcome to the Colleague Memory Task. Press next to begin.",
        "Let me tell you about my colleague Sarah from Marketing.",
        "Sarah has been with the company for five years.",
        "She is leading our new product launch next month.",
        "Sarah enjoys hiking on the weekends.",
        "You can reach Sarah at extension 2145.",
        "Thank you for viewing this presentation!"
      ];
      
      var currentPage = 0;
      
      function renderPage() {
        var contentDiv = document.getElementById("content");
        contentDiv.innerHTML = "";
        var img = document.createElement("img");
        img.src = imageSources[currentPage];
        img.alt = "Slide " + (currentPage + 1);
        contentDiv.appendChild(img);
        
        // Make Pepper say the text for the current page
        sayText(speechTexts[currentPage]);
        
        if (currentPage === imageSources.length - 1) {
          document.querySelector("button").style.display = "none";
        }
      }
      
      window.nextPage = function () {
        if (currentPage < imageSources.length - 1) {
          currentPage++;
          renderPage();
        }
      };
      
      // Initial page render and speech
      renderPage();
    };
  </script>
</body>
</html>
